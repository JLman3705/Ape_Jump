<script>const canvas=document.getElementById("gameCanvas"),ctx=canvas.getContext("2d"),bounceSound=document.getElementById("bounceSound"),bgMusic=document.getElementById("bgMusic"),monkey1=document.getElementById("monkey1"),monkey2=document.getElementById("monkey2"),palmTree=document.getElementById("palmTree");function resizeCanvas(){const e=Math.min(window.innerWidth,960),t=e*(9/16);canvas.width=e,canvas.height=t,canvas.style.width=e+"px",canvas.style.height=t+"px"}resizeCanvas(),window.addEventListener("resize",resizeCanvas);let monkey,gravity=.5,jumpStrength=-11,spikeSpeed=2,score=0,isGameOver=!1,frameCounter=0,spikes=[],trees=[];function getTrimmedBounds(e){const t=document.createElement("canvas"),n=t.getContext("2d");t.width=e.width,t.height=e.height,n.drawImage(e,0,0);const{data:i,width:a,height:o}=n.getImageData(0,0,e.width,e.height);let s=o,c=0,r=a,d=0;for(let e=0;e<o;e++)for(let t=0;t<a;t++){i[4*(e*a+t)+3]>0&&(e<s&&(s=e),e>c&&(c=e),t<r&&(r=t),t>d&&(d=t))}return{top:s,left:r,width:d-r+1,height:c-s+1}}function resetGame(){const e=canvas.height-10;monkey={x:40,y:e-32,width:32,height:32,dy:0,onGround:!0},score=0,isGameOver=!1,spikes=[],trees.length=0,document.getElementById("score").innerText=score,document.getElementById("restartBtn").style.display="none",bgMusic.currentTime=0,requestAnimationFrame(update)}function spawnSpikeAt(e){const t=canvas.height-30;spikes.push({x:e,y:t,width:20,height:20,passed:!1})}function spawnMoreSpikes(){let e=spikes.length?Math.max(...spikes.map((e=>e.x))):canvas.width;for(;e<canvas.width+600;){e+=200*Math.random()+100,spawnSpikeAt(e)}}function maybeSpawnPalmTree(){if(Math.random()<.01){const e=120,t=96;trees.push({x:canvas.width+50,y:canvas.height-e+2,width:t,height:e})}}function drawPalmTrees(){trees.forEach((e=>{ctx.drawImage(palmTree,e.x,e.y,e.width,e.height)}))}function jump(){!isGameOver&&monkey.onGround&&(monkey.dy=jumpStrength,monkey.onGround=!1,bounceSound.currentTime=0,bounceSound.play())}function drawMonkey(){const e=Math.floor(frameCounter/10)%2==0?monkey1:monkey2;e._trim||(e._trim=getTrimmedBounds(e));const t=e._trim,n=t.width,i=t.height,a=monkey.x+(monkey.width-n),o=monkey.y+(monkey.height-i);ctx.drawImage(e,t.left,t.top,t.width,t.height,a,o,t.width,t.height),frameCounter++}function drawFloor(){const e=canvas.height-10;ctx.strokeStyle="#228B22",ctx.lineWidth=2,ctx.beginPath(),ctx.moveTo(0,e),ctx.lineTo(canvas.width,e),ctx.stroke()}function drawSpikes(){ctx.fillStyle="#ff4444",spikes.forEach((e=>{ctx.beginPath(),ctx.moveTo(e.x,e.y+e.height),ctx.lineTo(e.x+e.width/2,e.y),ctx.lineTo(e.x+e.width,e.y+e.height),ctx.closePath(),ctx.fill()}))}function checkCollision(){return spikes.some((e=>monkey.x+monkey.width>e.x&&monkey.x<e.x+e.width&&monkey.y+monkey.height>e.y))}function update(){if(isGameOver)return;ctx.clearRect(0,0,canvas.width,canvas.height),ctx.fillStyle="#87ceeb",ctx.fillRect(0,40,canvas.width,canvas.height-50),monkey.dy+=gravity,monkey.y+=monkey.dy;const e=canvas.height-10;if(monkey.y+monkey.height>=e&&(monkey.y=e-monkey.height,monkey.dy=0,monkey.onGround=!0),spikes.forEach((e=>{e.x-=spikeSpeed,!e.passed&&e.x+e.width<monkey.x&&(e.passed=!0,score++,document.getElementById("score").innerText=score)})),trees.forEach((e=>e.x-=spikeSpeed)),trees=trees.filter((e=>e.x+e.width>0)),maybeSpawnPalmTree(),spikes=spikes.filter((e=>e.x+e.width>-50)),spawnMoreSpikes(),drawPalmTrees(),drawFloor(),drawMonkey(),drawSpikes(),checkCollision())return isGameOver=!0,document.getElementById("restartBtn").style.display="inline-block",void bgMusic.pause();requestAnimationFrame(update)}function restartGame(){resetGame()}canvas.addEventListener("click",jump),canvas.addEventListener("touchstart",(e=>{e.preventDefault(),jump()})),window.addEventListener("click",(()=>{bgMusic.paused&&!isGameOver&&bgMusic.play().catch((()=>{}))}),{once:!0}),resetGame()</script><script>const canvas=document.getElementById("gameCanvas"),ctx=canvas.getContext("2d"),bounceSound=document.getElementById("bounceSound"),bgMusic=document.getElementById("bgMusic"),monkey1=document.getElementById("monkey1"),monkey2=document.getElementById("monkey2"),palmTree=document.getElementById("palmTree");function resizeCanvas(){const e=Math.min(window.innerWidth,960),t=e*(9/16);canvas.width=e,canvas.height=t,canvas.style.width=e+"px",canvas.style.height=t+"px"}resizeCanvas(),window.addEventListener("resize",resizeCanvas);let monkey,gravity=.5,jumpStrength=-11,spikeSpeed=2,score=0,isGameOver=!1,frameCounter=0,spikes=[],trees=[];function getTrimmedBounds(e){const t=document.createElement("canvas"),n=t.getContext("2d");t.width=e.width,t.height=e.height,n.drawImage(e,0,0);const{data:i,width:a,height:o}=n.getImageData(0,0,e.width,e.height);let s=o,c=0,r=a,d=0;for(let e=0;e<o;e++)for(let t=0;t<a;t++){i[4*(e*a+t)+3]>0&&(e<s&&(s=e),e>c&&(c=e),t<r&&(r=t),t>d&&(d=t))}return{top:s,left:r,width:d-r+1,height:c-s+1}}function resetGame(){const e=canvas.height-10;monkey={x:40,y:e-32,width:32,height:32,dy:0,onGround:!0},score=0,isGameOver=!1,spikes=[],trees.length=0,document.getElementById("score").innerText=score,document.getElementById("restartBtn").style.display="none",bgMusic.currentTime=0,requestAnimationFrame(update)}function spawnSpikeAt(e){const t=canvas.height-30;spikes.push({x:e,y:t,width:20,height:20,passed:!1})}function spawnMoreSpikes(){let e=spikes.length?Math.max(...spikes.map((e=>e.x))):canvas.width;for(;e<canvas.width+600;){e+=200*Math.random()+100,spawnSpikeAt(e)}}function maybeSpawnPalmTree(){if(Math.random()<.01){const e=120,t=96;trees.push({x:canvas.width+50,y:canvas.height-e+2,width:t,height:e})}}function drawPalmTrees(){trees.forEach((e=>{ctx.drawImage(palmTree,e.x,e.y,e.width,e.height)}))}function jump(){!isGameOver&&monkey.onGround&&(monkey.dy=jumpStrength,monkey.onGround=!1,bounceSound.currentTime=0,bounceSound.play())}function drawMonkey(){const e=Math.floor(frameCounter/10)%2==0?monkey1:monkey2;e._trim||(e._trim=getTrimmedBounds(e));const t=e._trim,n=t.width,i=t.height,a=monkey.x+(monkey.width-n),o=monkey.y+(monkey.height-i);ctx.drawImage(e,t.left,t.top,t.width,t.height,a,o,t.width,t.height),frameCounter++}function drawFloor(){const e=canvas.height-10;ctx.strokeStyle="#228B22",ctx.lineWidth=2,ctx.beginPath(),ctx.moveTo(0,e),ctx.lineTo(canvas.width,e),ctx.stroke()}function drawSpikes(){ctx.fillStyle="#ff4444",spikes.forEach((e=>{ctx.beginPath(),ctx.moveTo(e.x,e.y+e.height),ctx.lineTo(e.x+e.width/2,e.y),ctx.lineTo(e.x+e.width,e.y+e.height),ctx.closePath(),ctx.fill()}))}function checkCollision(){return spikes.some((e=>monkey.x+monkey.width>e.x&&monkey.x<e.x+e.width&&monkey.y+monkey.height>e.y))}function update(){if(isGameOver)return;ctx.clearRect(0,0,canvas.width,canvas.height),ctx.fillStyle="#87ceeb",ctx.fillRect(0,40,canvas.width,canvas.height-50),monkey.dy+=gravity,monkey.y+=monkey.dy;const e=canvas.height-10;if(monkey.y+monkey.height>=e&&(monkey.y=e-monkey.height,monkey.dy=0,monkey.onGround=!0),spikes.forEach((e=>{e.x-=spikeSpeed,!e.passed&&e.x+e.width<monkey.x&&(e.passed=!0,score++,document.getElementById("score").innerText=score)})),trees.forEach((e=>e.x-=spikeSpeed)),trees=trees.filter((e=>e.x+e.width>0)),maybeSpawnPalmTree(),spikes=spikes.filter((e=>e.x+e.width>-50)),spawnMoreSpikes(),drawPalmTrees(),drawFloor(),drawMonkey(),drawSpikes(),checkCollision())return isGameOver=!0,document.getElementById("restartBtn").style.display="inline-block",void bgMusic.pause();requestAnimationFrame(update)}function restartGame(){resetGame()}canvas.addEventListener("click",jump),canvas.addEventListener("touchstart",(e=>{e.preventDefault(),jump()})),window.addEventListener("click",(()=>{bgMusic.paused&&!isGameOver&&bgMusic.play().catch((()=>{}))}),{once:!0}),resetGame()</script>
